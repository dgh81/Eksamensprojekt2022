package com.example.eksamensprojekt2022;

import android.content.Context;
import android.graphics.Bitmap;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.os.Environment;
import android.view.View;
import android.widget.Toast;

import androidx.appcompat.app.AppCompatActivity;

import com.itextpdf.io.image.ImageData;
import com.itextpdf.io.image.ImageDataFactory;
import com.itextpdf.kernel.colors.ColorConstants;
import com.itextpdf.kernel.pdf.PdfDocument;
import com.itextpdf.kernel.pdf.PdfWriter;
import com.itextpdf.layout.Document;
import com.itextpdf.layout.borders.Border;
import com.itextpdf.layout.element.AreaBreak;
import com.itextpdf.layout.element.Cell;
import com.itextpdf.layout.element.Image;
import com.itextpdf.layout.element.Paragraph;
import com.itextpdf.layout.element.Table;
import com.itextpdf.layout.property.HorizontalAlignment;
import com.itextpdf.layout.property.TextAlignment;
import com.itextpdf.layout.property.VerticalAlignment;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;
import java.util.ArrayList;
import java.util.Random;

public class CreatePDF extends AppCompatActivity {
    ArrayList<Integer> answers;
    int index = 0;
    Context context;

    public void createPdf(Context context) throws IOException {
        this.context = context;
        answers = answersInList();
        Table personalInfo = createTablePersonalInfo();
        Table questions = createTableQuestions();
        Table questionsPage2 = createTableQuestions();

        String pdfPath = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS).toString();
        File file = new File(pdfPath, "myPDF1.pdf");
        OutputStream outputstream = new FileOutputStream(file);

        PdfWriter writer = new PdfWriter(file);
        PdfDocument pdfDocument = new PdfDocument(writer);
        Document document = new Document(pdfDocument);

        document.add(createHeader(1));
        document.add(new Paragraph("Elinstallation - Vertifikation af mindre elinstallation").setFontSize(18f).setPaddingTop(5f));

        document.add(personalInfo);

        ArrayList<String> questionsGenerelt = questionGroup1();
        ArrayList<String> questionsTavlen = questionGroup2();
        ArrayList<String> questionsInstallation = questionGroup3();
        ArrayList<String> questionsIndbygningsarmaturer = questionGroup4();
        ArrayList<String> questionsBeskyttelsesledere = questionGroup5();
        ArrayList<String> questionsFejlbeskyttelse = questionGroup6();

        questions.addCell(new Cell(2, 1).add(new Paragraph("")).setTextAlignment(TextAlignment.CENTER).setBorder(Border.NO_BORDER));
        questions.addCell(new Cell(2, 1).add(new Paragraph("Ja")).setTextAlignment(TextAlignment.CENTER).setBorder(Border.NO_BORDER));
        questions.addCell(new Cell(2, 1).add(new Paragraph("Nej")).setTextAlignment(TextAlignment.CENTER).setBorder(Border.NO_BORDER));
        questions.addCell(new Cell(2, 1).add(new Paragraph("Ikke relevant")).setTextAlignment(TextAlignment.CENTER).setBorder(Border.NO_BORDER));
        questions.addCell(new Cell(1, 4).add(new Paragraph("1. Generelt:").setBold()).setBorder(Border.NO_BORDER));

        for (int i = 0; i < questionsGenerelt.size(); i++) {
            questions.addCell(new Cell().add(new Paragraph(questionsGenerelt.get(i))).setBorder(Border.NO_BORDER));
            createCheckbox(answers.get(index), questions);
        }

        questions.addCell(new Cell(1, 4).add(new Paragraph("\n2. Tavlen:").setBold()).setBorder(Border.NO_BORDER));
        for (int i = 0; i < questionsTavlen.size(); i++) {
            questions.addCell(new Cell().add(new Paragraph(questionsTavlen.get(i))).setBorder(Border.NO_BORDER));
            createCheckbox(answers.get(index), questions);
        }

        document.add(questions);

        document.add(new AreaBreak());
        document.add(createHeader(2));


        questionsPage2.addCell(new Cell(1, 4).add(new Paragraph("\n3. Installation:").setBold()).setBorder(Border.NO_BORDER));
        for (int i = 0; i < questionsInstallation.size(); i++) {
            questionsPage2.addCell(new Cell().add(new Paragraph(questionsInstallation.get(i))).setBorder(Border.NO_BORDER));
            createCheckbox(answers.get(index), questionsPage2);
        }

        questionsPage2.addCell(new Cell(1, 4).add(new Paragraph("\n4. Indbygningsarmaturer:").setBold()).setBorder(Border.NO_BORDER));
        for (int i = 0; i < questionsIndbygningsarmaturer.size(); i++) {
            questionsPage2.addCell(new Cell().add(new Paragraph(questionsIndbygningsarmaturer.get(i))).setBorder(Border.NO_BORDER));
            createCheckbox(answers.get(index), questionsPage2);
        }

        questionsPage2.addCell(new Cell(1, 4).add(new Paragraph("\n5. Beskyttelsesledere og udligningsforbindelser:").setBold()).setBorder(Border.NO_BORDER));
        for (int i = 0; i < questionsBeskyttelsesledere.size(); i++) {
            questionsPage2.addCell(new Cell().add(new Paragraph(questionsBeskyttelsesledere.get(i))).setBorder(Border.NO_BORDER));
            createCheckbox(answers.get(index), questionsPage2);
        }

        questionsPage2.addCell(new Cell(1, 4).add(new Paragraph("\n6. Fejlbeskyttelse/supplerende beskyttelse:\n").setBold()).setBorder(Border.NO_BORDER));
        for (int i = 0; i < questionsFejlbeskyttelse.size(); i++) {
            questionsPage2.addCell(new Cell().add(new Paragraph(questionsFejlbeskyttelse.get(i))).setBorder(Border.NO_BORDER));
            createCheckbox(answers.get(index), questionsPage2);
        }

        document.add(questionsPage2);

        document.add(new AreaBreak());
        document.add(createHeader(3));
        document.add(new Paragraph("MÃ¥leresultater").setFontSize(18f).setPaddingTop(5f));

        document.add(createTableKredsdetaljer(5));
        document.add(createTableAfprovning(5));
        document.add(createTableKortslutning(5));
        document.add(createTableBemaerkninger());

        document.close();
        Toast.makeText(context, "Pdf Created", Toast.LENGTH_LONG).show();
    }

    public Table createHeader(int page) {
        Drawable drawable = context.getDrawable(R.drawable.zealand);
        Bitmap bitmap = ((BitmapDrawable)drawable).getBitmap();
        ByteArrayOutputStream stream = new ByteArrayOutputStream();
        bitmap.compress(Bitmap.CompressFormat.PNG, 100, stream);
        byte[] bitmapData = stream.toByteArray();

        ImageData imageData = ImageDataFactory.create(bitmapData);
        Image logo = new Image(imageData);
        logo.setHorizontalAlignment(HorizontalAlignment.CENTER);
        logo.setHeight(54f);


        float[] columnWidth = {2000f, 2000f, 2000f};
        Table header = new Table(columnWidth);
        header.setHorizontalAlignment(HorizontalAlignment.CENTER);
        header.setTextAlignment(TextAlignment.CENTER);
        header.setPadding(0);

        header.addCell(new Cell(4,1).add(logo).setHorizontalAlignment(HorizontalAlignment.CENTER).setVerticalAlignment(VerticalAlignment.MIDDLE));
        header.addCell(new Cell(4,1).add(new Paragraph("Tjekliste").setFontSize(36f).setFontColor(ColorConstants.ORANGE).setHorizontalAlignment(HorizontalAlignment.CENTER).setVerticalAlignment(VerticalAlignment.BOTTOM)));
        header.addCell(new Cell().add(new Paragraph("").setHeight(14f)));
        header.addCell(new Cell().add(new Paragraph("").setHeight(14f)));
        header.addCell(new Cell().add(new Paragraph("Side " + page + " af 3")));
        header.addCell(new Cell().add(new Paragraph("Elinstallation")));

        return header;
    }

    public Cell createCheckboxOn() {
        Table checkbox = new Table(1);
        checkbox.addCell(new Cell().add(createTick()).setHorizontalAlignment(HorizontalAlignment.CENTER).setVerticalAlignment(VerticalAlignment.MIDDLE));

        return new Cell().add(checkbox.setVerticalAlignment(VerticalAlignment.MIDDLE).setHorizontalAlignment(HorizontalAlignment.CENTER)).setBorder(Border.NO_BORDER);
    }

    public Cell createCheckboxOff() {
        Table checkboxOff = new Table(1);
        checkboxOff.setHeight(13f);
        checkboxOff.setWidth(13f);
        checkboxOff.addCell(new Cell());

        return new Cell().add(checkboxOff.setVerticalAlignment(VerticalAlignment.MIDDLE).setHorizontalAlignment(HorizontalAlignment.CENTER)).setBorder(Border.NO_BORDER);
    }

    public Image createTick() {
        Drawable tickDrawable = context.getDrawable(R.drawable.tick);
        Bitmap tickBitmap = ((BitmapDrawable)tickDrawable).getBitmap();
        ByteArrayOutputStream tickStream = new ByteArrayOutputStream();
        tickBitmap.compress(Bitmap.CompressFormat.PNG, 100, tickStream);
        byte[] tickBitmapData = tickStream.toByteArray();

        ImageData tickImageData = ImageDataFactory.create(tickBitmapData);
        Image tick = new Image(tickImageData);
        tick.setHeight(8f);
        tick.setWidth(8f);
        tick.setHorizontalAlignment(HorizontalAlignment.CENTER);

        return tick;
    }

    public void createCheckbox(int answer, Table table) {
        if (answer == 1) {
            table.addCell(new Cell().add(createCheckboxOn()).setBorder(Border.NO_BORDER));
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
        } else if (answer == 2) {
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
            table.addCell(new Cell().add(createCheckboxOn()).setBorder(Border.NO_BORDER));
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
        } else if (answer == 3) {
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
            table.addCell(new Cell().add(createCheckboxOn()).setBorder(Border.NO_BORDER));
        } else {
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
            table.addCell(new Cell().add(createCheckboxOff()).setBorder(Border.NO_BORDER));
        }
        index++;
    }

    public ArrayList<String> questionGroup1() {
        ArrayList<String> questionsGenerelt = new ArrayList<>();
        questionsGenerelt.add("Er der taget hensyn til ydre pÃ¥virkninger og anvendt korrekt kapslingsklasse?");
        questionsGenerelt.add("Er der brandtÃ¦tnet ved gennemfÃ¸ringer?");
        questionsGenerelt.add("Er installationen isolationsprÃ¸vet?");
        questionsGenerelt.add("Er der foretaget polaritetsprÃ¸ve og kontrol af fasefÃ¸lgen?");
        questionsGenerelt.add("Er der foretaget funktionsprÃ¸ver af installationen?");
        questionsGenerelt.add("Er nul- og beskyttelsesledere korrekt identificeret?");
        questionsGenerelt.add("Er ledere korrekt overstrÃ¸msbeskyttet og valgt efter strÃ¸mvÃ¦rdi?");
        questionsGenerelt.add("Er SPDâer (overspÃ¦ndingsbeskyttelsesudstyr) korrekt valgt og installeret?");
        questionsGenerelt.add("Er permanent tilsluttede brugsgenstande egnet til den pÃ¥gÃ¦ldende anvendelse?");
        questionsGenerelt.add("Er nÃ¸dvendig dokumentation til stede?");
        questionsGenerelt.add("Er spÃ¦ndingsfald kontrolleret?");
        questionsGenerelt.add("Er der foretaget foranstaltninger mod elektromagnetiske pÃ¥virkninger?");
        questionsGenerelt.add("Er ejer/bruger informeret om funktion og betjening?");

        return questionsGenerelt;
    }

    public ArrayList<String> questionGroup2() {
        ArrayList<String> questionsTavlen = new ArrayList<>();
        questionsTavlen.add("Er der tilstrÃ¦kkelig plads til at arbejde pÃ¥/adgang til tavlen?");
        questionsTavlen.add("Er overstrÃ¸msbeskyttelsesudstyr korrekt valgt og evt. indstillet?");
        questionsTavlen.add("Er der en entydig mÃ¦rkning af beskyttelsesudstyr med tilhÃ¸rsforhold?");
        questionsTavlen.add("Er der mÃ¦rkning om max. mÃ¦rke-/indstillingsstrÃ¸m?");
        questionsTavlen.add("Er mÃ¦rkning med oplysninger om tekniske data for tavlen foretaget?");
        questionsTavlen.add("Er udgÃ¥ende beskyttelsesledere anbragt i separate klemmer i tavlen?");
        questionsTavlen.add("Er afdÃ¦kning og dÃ¦kplader monteret?");
        questionsTavlen.add("Er indfÃ¸ringer tilpasset/tÃ¦tnet, sÃ¥ tavlens kapslingsklasse er som mÃ¦rket?");

        return questionsTavlen;
    }

    public ArrayList<String> questionGroup3() {
        ArrayList<String> questionsInstallation = new ArrayList<>();
        questionsInstallation.add("Er udstyr til adskillelse og afbrydelse korrekt valgt, placeret og installeret?");
        questionsInstallation.add("Er stikkontakter og udtag m.m. installeret i henhold til gÃ¦ldende bestemmelser?");
        questionsInstallation.add("Er kabler/ledninger korrekt oplagt, afsluttet og forbundet?");
        questionsInstallation.add("Er kabler beskyttet mod mekanisk overlast ved opfÃ¸ringer fra gulv/jord?");
        questionsInstallation.add("Er tilledninger aflastet for trÃ¦k og vridning ved tilslutning til installationen?");
        questionsInstallation.add("Er alle dÃ¦ksler og afdÃ¦kninger monteret, sÃ¥ der ikke er berÃ¸ringsfare?");
        questionsInstallation.add("Er alle samlinger let tilgÃ¦ngelige?");

        return questionsInstallation;
    }

    public ArrayList<String> questionGroup4() {
        ArrayList<String> questionsIndbygningsarmaturer = new ArrayList<>();
        questionsIndbygningsarmaturer.add("Er indbygningsarmaturer korrekt valgt og monteret?");
        questionsIndbygningsarmaturer.add("Er indbygningsarmaturer installeret sÃ¥ledes, at overophedning undgÃ¥s?");

        return questionsIndbygningsarmaturer;
    }

    public ArrayList<String> questionGroup5() {
        ArrayList<String> questionsBeskyttelsesledere = new ArrayList<>();
        questionsBeskyttelsesledere.add("Er jordingslederen korrekt valgt (minimum 6 mm\u00B2)?");
        questionsBeskyttelsesledere.add("Er der etableret beskyttende potentialudligning?");
        questionsBeskyttelsesledere.add("Er supplerende beskyttende potentialudligning etableret?");
        questionsBeskyttelsesledere.add("Er den gennemgÃ¥ende forbindelse i udligningsforbindelser kontrolleret?");
        questionsBeskyttelsesledere.add("Er den gennemgÃ¥ende forbindelse i beskyttelsesledere kontrolleret?");
        questionsBeskyttelsesledere.add("Er overgangsmodstand for jordelektroden kontrolleret?");

        return questionsBeskyttelsesledere;
    }

    public ArrayList<String> questionGroup6() {
        ArrayList<String> questionsFejlbeskyttelse = new ArrayList<>();
        questionsFejlbeskyttelse.add("Er beskyttelsesmetode korrekt valgt i forhold til installationstype og systemjording?");
        questionsFejlbeskyttelse.add("Er RCDâer (fejlstrÃ¸msafbrydere) kontrolleret og afprÃ¸vet?");
        questionsFejlbeskyttelse.add("Er klasse I brugsgenstande tilsluttet til beskyttelseslederen?");

        return questionsFejlbeskyttelse;
    }

    public ArrayList<Integer> answersInList() {
        ArrayList<Integer> answers = new ArrayList<>();
        for (int i = 0; i < 39; i++) {
            answers.add(randomNumber());
            System.out.println(randomNumber());
        }
        return answers;
    }

    public int randomNumber() {
        int max = 3;
        int min = 1;
        Random random = new Random();
        return random.nextInt(max - min + 1) + min;
    }

    private Table createTablePersonalInfo() {
        float[] columnWidth1 = {150, 200, 200};
        Table personalInfo = new Table(columnWidth1);
        personalInfo.setFontSize(10f);
        personalInfo.setPadding(0);

        personalInfo.addCell(new Cell(1, 3).add(new Paragraph("Kundenavn: ")));
        personalInfo.addCell(new Cell(1, 3).add(new Paragraph("Adresse: ")));
        personalInfo.addCell(new Cell().add(new Paragraph("Post nr: ")));
        personalInfo.addCell(new Cell().add(new Paragraph("By: ")));
        personalInfo.addCell(new Cell().add(new Paragraph("Ordernummer: ")));
        personalInfo.addCell(new Cell(1, 3).add(new Paragraph("Identifikation af installationen: ")));
        personalInfo.addCell(new Cell(1, 3).add(new Paragraph("Installationen er udfÃ¸rt af: ")));
        personalInfo.addCell(new Cell(1, 2).add(new Paragraph("Verifikation af installationen er udfÃ¸rt af: ")));
        personalInfo.addCell(new Cell().add(new Paragraph("Dato: ")));

        return personalInfo;
    }

    private Table createTableQuestions() {
        float[] columnWidth2 = {450, 30, 30, 30};
        Table questions = new Table(columnWidth2);
        questions.setFontSize(10f);
        questions.setPadding(0);

        return questions;
    }

    public Table createTableKredsdetaljer(int rows) {
        float[] columnWidth = {150, 150, 150, 150, 150, 75, 75, 150};
        Table table = new Table(columnWidth);
        table.setTextAlignment(TextAlignment.CENTER);
        table.setFontSize(10f);
        table.setPadding(0);

        table.addCell(new Cell(1,8).add(new Paragraph("Kredsdetaljer").setTextAlignment(TextAlignment.LEFT)).setBackgroundColor(ColorConstants.GRAY));
        table.addCell(new Cell().add(new Paragraph("Gruppe")));
        table.addCell(new Cell().add(new Paragraph("OB (I\u2099)")));
        table.addCell(new Cell().add(new Paragraph("Karakteristik")));
        table.addCell(new Cell().add(new Paragraph("TvÃ¦rsnit")));
        table.addCell(new Cell().add(new Paragraph("Maks. OB")));
        table.addCell(new Cell().add(new Paragraph("Zs")));
        table.addCell(new Cell().add(new Paragraph("RA")));
        table.addCell(new Cell().add(new Paragraph("Isolation")));

        if (rows > 0) {
            for (int i = 0; i < rows; i++) {
                table.addCell(new Cell().add(new Paragraph("Lala").setTextAlignment(TextAlignment.LEFT)));
                table.addCell(new Cell().add(new Paragraph("12" + " A").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("Boom boom").setTextAlignment(TextAlignment.LEFT)));
                table.addCell(new Cell().add(new Paragraph("54" + " mm\u00B2").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("6" + " A").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell(1, 2).add(new Paragraph("9" + " Ohm").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("25" + " Ohm").setTextAlignment(TextAlignment.RIGHT)));
            }
        }

        table.addCell(new Cell(1, 8).setBorder(Border.NO_BORDER).setHeight(10f));
        table.addCell(new Cell(1, 5).add(new Paragraph("Overgangsmodstand for jordingsleder og jordelektrode R:").setTextAlignment(TextAlignment.LEFT)).setBorderRight(Border.NO_BORDER));
        table.addCell(new Cell(1, 3).add(new Paragraph("8954" + " Ohm").setTextAlignment(TextAlignment.RIGHT)).setBorderLeft(Border.NO_BORDER));
        table.addCell(new Cell(1, 8).setBorder(Border.NO_BORDER).setHeight(10f));


        return table;
    }

    public Table createTableAfprovning(int rows) {
        float[] columnWidth = {150, 150, 150, 150, 150, 150, 150, 150};
        Table table = new Table(columnWidth);
        table.setTextAlignment(TextAlignment.CENTER);
        table.setFontSize(10f);
        table.setPadding(0);

        table.addCell(new Cell(1,8).add(new Paragraph("AfprÃ¸vning af RCDâer").setTextAlignment(TextAlignment.LEFT)).setBackgroundColor(ColorConstants.GRAY));
        table.addCell(new Cell(2, 1).add(new Paragraph("")));
        table.addCell(new Cell(2, 4).add(new Paragraph("Sinus (Type A og AC)")));
        table.addCell(new Cell(2, 2).add(new Paragraph("Pulserende overlejret \npÃ¥ 6 mA d.c. (Type-A)")));
        table.addCell(new Cell(2, 1).add(new Paragraph("PrÃ¸ve\u0002knap")));

        //Trekant virker ikke
        table.addCell(new Cell().add(new Paragraph("RCD")));
        table.addCell(new Cell().add(new Paragraph("0Âº 1xIân")));
        table.addCell(new Cell().add(new Paragraph("180Âº 1xIân")));
        table.addCell(new Cell().add(new Paragraph("0Âº 5xIân")));
        table.addCell(new Cell().add(new Paragraph("0Âº Â½xIân")));
        table.addCell(new Cell().add(new Paragraph("0Âº 1xIân")));
        table.addCell(new Cell().add(new Paragraph("180Âº 1xIân")));
        table.addCell(new Cell().add(new Paragraph("OK")));

        if (rows > 0) {
            for (int i = 0; i < rows; i++) {
                table.addCell(new Cell().add(new Paragraph("Lala").setTextAlignment(TextAlignment.LEFT)));
                table.addCell(new Cell().add(new Paragraph("12").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("Boom boom").setTextAlignment(TextAlignment.LEFT)));
                table.addCell(new Cell().add(new Paragraph("54").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("6").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("9").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("25").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("AV!").setTextAlignment(TextAlignment.LEFT)));
            }
        }
        table.addCell(new Cell(1, 8).setBorder(Border.NO_BORDER).setHeight(10f));

        return table;
    }

    public Table createTableKortslutning(int rows) {
        float[] columnWidth = {150, 150, 150, 150, 150, 150, 150, 150};
        Table table = new Table(columnWidth);
        table.setTextAlignment(TextAlignment.CENTER);
        table.setFontSize(10f);
        table.setPadding(0);

        table.addCell(new Cell(1,4).add(new Paragraph("KortslutningsstrÃ¸m ").setTextAlignment(TextAlignment.LEFT)).setBackgroundColor(ColorConstants.GRAY));
        table.addCell(new Cell(1,4).add(new Paragraph("SpÃ¦ndingsfald").setTextAlignment(TextAlignment.LEFT)).setBackgroundColor(ColorConstants.GRAY));

        table.addCell(new Cell().add(new Paragraph("Gruppe")));
        table.addCell(new Cell().add(new Paragraph("Ik")));
        table.addCell(new Cell(1, 2).add(new Paragraph("MÃ¥lt i punkt")));
        table.addCell(new Cell().add(new Paragraph("Gruppe")));
        table.addCell(new Cell().add(new Paragraph("ÎU")));
        table.addCell(new Cell(1, 2).add(new Paragraph("MÃ¥lt i punkt")));

        if (rows > 0) {
            for (int i = 0; i < rows; i++) {
                table.addCell(new Cell().add(new Paragraph("Lala").setTextAlignment(TextAlignment.LEFT)));
                table.addCell(new Cell().add(new Paragraph("12" + " kA").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell(1, 2).add(new Paragraph("54").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell().add(new Paragraph("Boooom").setTextAlignment(TextAlignment.LEFT)));
                table.addCell(new Cell().add(new Paragraph("6" + " %").setTextAlignment(TextAlignment.RIGHT)));
                table.addCell(new Cell(1, 2).add(new Paragraph("AV!").setTextAlignment(TextAlignment.LEFT)));
            }
        }
        table.addCell(new Cell(1, 8).setBorder(Border.NO_BORDER).setHeight(10f));

        return table;
    }

    public Table createTableBemaerkninger() {
        float[] columnWidth = {1000};
        Table table = new Table(columnWidth);
        table.setPadding(0);


        table.addCell(new Cell().add(new Paragraph("BemÃ¦rkning:")).setBackgroundColor(ColorConstants.GRAY));
        table.addCell(new Cell().add(new Paragraph("Lorem ipsum dolor sit amet, consectetur adipiscing elit. Donec sodales ante ex, ac egestas libero pellentesque nec. " +
                "Vestibulum mattis imperdiet facilisis. Pellentesque aliquam magna quis luctus tristique. " +
                "Proin ac interdum leo. Curabitur eget ultrices sapien, pretium ullamcorper ligula. Ut quis risus luctus, ").setMultipliedLeading(1.0f)));

        return table;
    }
}
